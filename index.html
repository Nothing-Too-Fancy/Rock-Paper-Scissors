<!DOCTYPE html>
<html>
    <body></body>
    <script>
        const rock = 'Rock';
        const paper = 'Paper';
        const scissors = 'Scissors';

        function computerPlay() {
            let random = Math.floor(Math.random() * 15);
            
            if(random >= 0 && random <= 4)
                return rock;
            else if (random >= 5 && random <= 9)
                return paper;
            else if (random >= 10 && random <= 14)
                return scissors;
        }

        function playRound(playerSelection, computerSelection){

            playerSelection = capitalize(playerSelection);
            computerSelection = capitalize(computerSelection);

            switch(playerSelection){
                case rock:
                    switch(computerSelection){
                        case paper:
                            return youLose(computerSelection, playerSelection);
                        break;
                        case scissors:
                            return youWin(playerSelection, computerSelection);
                        break;
                        case rock:
                            return 'It\'s a tie game!';
                        default:
                            return ': invalid Computer selection. Please try again.';
                    }
                break;
                case paper:
                    switch(computerSelection){
                        case scissors:
                            return youLose(computerSelection, playerSelection);
                        break;
                        case rock:
                            return youWin(playerSelection, computerSelection);
                        break;
                        case paper:
                            return 'It\'s a tie game!';
                        default:
                            return 'invalid Computer selection. Please try again.';
                    }
                break;
                case scissors:
                    switch(computerSelection){
                        case rock:
                            return youLose(computerSelection, playerSelection);
                        break;
                        case paper:
                            return youWin(playerSelection, computerSelection);
                        break;
                        case scissors:
                            return 'It\'s a tie game!';
                        default:
                            return 'invalid Computer selection. Please try again.';
                    }
                break;
                default:
                    return 'invalid Player selection. Please try again.'
            }
        }

        function game(numOfRounds){
            let playerWins = 0;
            let computerWins = 0;
            for(let i = 0; i < numOfRounds; i++){
                let playerSelection = prompt("Rock, Paper, Scissors?");
                let winner = playRound(playerSelection, computerPlay());
                console.log(winner);
                if (winner[4] == 'W') playerWins++;
                else if(winner[4] == 'L') computerWins++;
            }
            console.log('Player: ' + playerWins + '  Computer: ' + computerWins);
            while(playerWins == computerWins){
                console.log('All tied up. Playing sudden death game...');
                let winner = playRound('Rock', computerPlay());
                console.log(winner);
                if (winner[4] == 'W') playerWins++;
                else if(winner[4] == 'L') computerWins++;
                console.log('Player: ' + playerWins + '  Computer: ' + computerWins);
            }
            console.log(playerWins > computerWins ? 'You win!' : 'You lose!');
        }

        function capitalize(str){
            let firstLetter = str[0].toUpperCase();
            let theRest = str.substring(1, str.length);
            theRest = theRest.toLowerCase();
            return firstLetter + theRest;
        }

        function youLose(winner, loser){
            return 'You Lose! ' + winner + ' beats ' + loser;
        }

        function youWin(winner, loser){
            return 'You Win! ' + winner + ' beats ' + loser; 
        }

        let numOfRounds = prompt("How many rounds do you wish to play?");
        game(numOfRounds);

    </script>
</html>